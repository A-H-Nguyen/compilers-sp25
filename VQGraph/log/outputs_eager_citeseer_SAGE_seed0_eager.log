/work2/09808/mp46753/frontera/ML_Project/VQGraph/vq.py:283: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled=False)
/work2/09808/mp46753/frontera/ML_Project/VQGraph/vq.py:418: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled=False)
/work2/09808/mp46753/frontera/ML_Project/miniconda3/envs/txgnn_env/lib/python3.8/site-packages/dgl/dataloading/dataloader.py:1144: DGLWarning: Dataloader CPU affinity opt is not enabled, consider switching it on (see enable_cpu_affinity() or CPU best practices for DGL [https://docs.dgl.ai/tutorials/cpu/cpu_best_practises.html])
  dgl_warning(
/work2/09808/mp46753/frontera/ML_Project/miniconda3/envs/txgnn_env/lib/python3.8/site-packages/dgl/heterograph.py:92: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning(
Saved sparsity snapshot to outputs_eager/tran/citeseer/SAGE/seed_0/sparsity_before.csv
                     layer_name  num_elements    sparsity
0  encoder.graph_layer_1.weight      13712209   49.980452
1    encoder.graph_layer_1.bias          3703  100.000000
2  encoder.graph_layer_2.weight        473984   50.075952
3    encoder.graph_layer_2.bias           128  100.000000
4      encoder.decoder_1.weight      13712209   49.997057
5        encoder.decoder_1.bias          3703   50.418580
6      encoder.decoder_2.weight      13712209   49.985301
7        encoder.decoder_2.bias          3703   50.634621
8         encoder.linear.weight           768   52.473958
9           encoder.linear.bias             6   50.000000
Saved sparsity snapshot to outputs_eager/tran/citeseer/SAGE/seed_0/sparsity_after.csv
                     layer_name  num_elements   sparsity
0  encoder.graph_layer_1.weight      13712209  59.879090
1    encoder.graph_layer_1.bias          3703  73.318931
2  encoder.graph_layer_2.weight        473984  49.899786
3    encoder.graph_layer_2.bias           128  70.312500
4      encoder.decoder_1.weight      13712209  50.198236
5        encoder.decoder_1.bias          3703  50.499595
6      encoder.decoder_2.weight      13712209  49.994643
7        encoder.decoder_2.bias          3703  48.339184
8         encoder.linear.weight           768  51.041667
9           encoder.linear.bias             6  66.666667
Saved forward timing report to outputs_eager/tran/citeseer/SAGE/seed_0/forward_times.csv
               layer_name  avg_forward_time_ms  num_calls
0         encoder.dropout             0.000165       3005
1   encoder.graph_layer_1             0.000243       3005
2   encoder.graph_layer_2             0.000244       3005
3       encoder.decoder_1             0.000219       3005
4       encoder.decoder_2             0.000204       3005
5          encoder.linear             0.000203       3005
6   encoder.vq.project_in             0.000155       3005
7  encoder.vq.project_out             0.000214       3005
8    encoder.vq._codebook             0.000241       3005
CPU Memory Usage: 1218.55 MB
Max GPU Memory Used: 1469.04 MB

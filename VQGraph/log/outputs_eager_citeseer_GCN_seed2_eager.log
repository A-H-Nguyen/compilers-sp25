/work2/09808/mp46753/frontera/ML_Project/VQGraph/vq.py:283: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled=False)
/work2/09808/mp46753/frontera/ML_Project/VQGraph/vq.py:418: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  @autocast(enabled=False)
Saved sparsity snapshot to outputs_eager/tran/citeseer/GCN/seed_2/sparsity_before.csv
                     layer_name  num_elements    sparsity
0  encoder.graph_layer_1.weight      13712209   49.998815
1    encoder.graph_layer_1.bias          3703  100.000000
2  encoder.graph_layer_2.weight        473984   50.087556
3    encoder.graph_layer_2.bias           128  100.000000
4      encoder.decoder_1.weight      13712209   49.989539
5        encoder.decoder_1.bias          3703   50.391574
6      encoder.decoder_2.weight      13712209   50.005422
7        encoder.decoder_2.bias          3703   49.635431
8         encoder.linear.weight           768   48.307292
9           encoder.linear.bias             6   50.000000
Saved sparsity snapshot to outputs_eager/tran/citeseer/GCN/seed_2/sparsity_after.csv
                     layer_name  num_elements   sparsity
0  encoder.graph_layer_1.weight      13712209  49.915816
1    encoder.graph_layer_1.bias          3703   0.189036
2  encoder.graph_layer_2.weight        473984  50.098948
3    encoder.graph_layer_2.bias           128  23.437500
4      encoder.decoder_1.weight      13712209  50.069314
5        encoder.decoder_1.bias          3703  50.553605
6      encoder.decoder_2.weight      13712209  49.557930
7        encoder.decoder_2.bias          3703  39.805563
8         encoder.linear.weight           768  48.828125
9           encoder.linear.bias             6  50.000000
Saved forward timing report to outputs_eager/tran/citeseer/GCN/seed_2/forward_times.csv
               layer_name  avg_forward_time_ms  num_calls
0         encoder.dropout             0.000183       1001
1   encoder.graph_layer_1             0.000251       1001
2   encoder.graph_layer_2             0.000243       1001
3       encoder.decoder_1             0.000219       1001
4       encoder.decoder_2             0.000229       1001
5          encoder.linear             0.000232       1001
6   encoder.vq.project_in             0.000180       1001
7  encoder.vq.project_out             0.000238       1001
8    encoder.vq._codebook             0.000265       1001
CPU Memory Usage: 1258.63 MB
Max GPU Memory Used: 1691.82 MB
